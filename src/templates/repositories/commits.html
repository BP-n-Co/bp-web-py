<div class="flex">
  <div class="w-1/2">
    <label class="block">
      <input type="radio" name="option" value="Additions" x-model="selected" />
      Additions
    </label>

    <label class="block">
      <input type="radio" name="option" value="Deletions" x-model="selected" />
      Deletions
    </label>

    <label class="block">
      <input
        type="radio"
        name="option"
        value="Modifications"
        x-model="selected"
      />
      Modifications
    </label>
  </div>
  <div class="w-1/2">
    <span>Cumulative</span>
    <input type="checkbox" x-model="cumul" />
  </div>
</div>

<!-- prettier-ignore -->
<canvas
    id="myChart"
    x-init='
    const unsorted_commits = JSON.parse(`{{ commits | tojson(indent=none) | safe }}`);
    commits = unsorted_commits.sort((a, b) => b.committedDate.localeCompare(a.committedDate));
    '
    x-effect='
    if (selected === "Additions") {
        keys = ["additions"];
    } else if (selected === "Deletions") {
        keys = ["deletions"];
    } else {
        keys = ["additions", "deletions"];
    }
    const modifications = extractModificationsPerDay(commits, keys, cumul);
    const dataPoints = modifications.map(modification => ({
      x: modification.date,
      y: modification.modifications
    }));
    if (chart) {
      chart.destroy()
    }
    chart = new Chart($el, {
      type: "line",
      data: {
        datasets: [{
          label: selected,
          data: dataPoints,
          borderColor: "rgb(75, 192, 192)",
          tension: 0.1,
        }]
      },
      options: {
        plugins: {
          legend: {
            display: false
          }
        },
        scales: {
          x: {
            type: "time",
            time: {
              unit: "day"
            }
          },
          y: {
            beginAtZero: true
          }
        }
      }
    });
    '
  ></canvas>
